{% extends 'base.html' %}

{% block extra_css %}
<style>
    /* Reuse Add Room Styles */
    @keyframes fadeInUp { from { opacity: 0; transform: translateY(30px); } to { opacity: 1; transform: translateY(0); } }
    .animate-up { animation: fadeInUp 0.7s cubic-bezier(0.2, 0.8, 0.2, 1) forwards; opacity: 0; }
    .form-card-container { max-width: 800px; margin: 40px auto 80px; background: white; padding: 50px; border-radius: 24px; box-shadow: 0 20px 50px rgba(0,0,0,0.06); }
    .form-header { text-align: center; margin-bottom: 30px; }
    .form-header h2 { font-size: 2rem; font-weight: 800; color: var(--dark); margin-bottom: 5px; }
    .form-group { margin-bottom: 24px; }
    .form-label { display: block; margin-bottom: 8px; font-weight: 700; color: var(--dark); font-size: 0.95rem; }
    .form-input, .form-textarea { width: 100%; padding: 16px 20px; border: 2px solid #e5e7eb; border-radius: 14px; font-size: 1rem; transition: all 0.2s ease; background: #fcfcfc; color: var(--dark); }
    .form-input:focus, .form-textarea:focus { border-color: var(--primary); background: white; outline: none; box-shadow: 0 0 0 4px rgba(255, 56, 92, 0.1); }
    .amenities-grid { display: grid; grid-template-columns: repeat(auto-fill, minmax(160px, 1fr)); gap: 12px; margin-top: 10px; }
    .amenity-checkbox { display: none; }
    .amenity-label { display: flex; align-items: center; justify-content: center; padding: 12px 15px; background: white; border: 2px solid #e5e7eb; border-radius: 12px; cursor: pointer; font-weight: 600; font-size: 0.9rem; color: #666; transition: all 0.2s; user-select: none; }
    .amenity-label:hover { border-color: #ccc; transform: translateY(-2px); }
    .amenity-checkbox:checked + .amenity-label { border-color: var(--primary); background: #fff0f3; color: var(--primary); box-shadow: 0 4px 12px rgba(255, 56, 92, 0.15); }
    .image-upload-box { background: #f8fafc; padding: 24px; border-radius: 16px; border: 2px dashed #cbd5e1; transition: border-color 0.2s; }
    .add-img-btn { background: white; border: 2px solid #cbd5e1; color: #64748b; padding: 10px 20px; border-radius: 10px; font-weight: 600; cursor: pointer; transition: all 0.2s; display: inline-flex; align-items: center; gap: 8px; margin-top: 10px; font-size: 0.9rem; }
    .submit-btn { width: 100%; padding: 20px; background: linear-gradient(135deg, #ff385c 0%, #e61e4d 100%); color: white; border: none; border-radius: 50px; font-size: 1.1rem; font-weight: 700; cursor: pointer; transition: transform 0.2s, box-shadow 0.2s; margin-top: 30px; box-shadow: 0 10px 25px rgba(255, 56, 92, 0.25); }
    .submit-btn:hover { transform: translateY(-3px); box-shadow: 0 15px 35px rgba(255, 56, 92, 0.35); }
</style>
{% endblock %}

{% block content %}
<div class="container animate-up">
    <div class="form-card-container">
        <div class="form-header">
            <h2>Edit Room Details</h2>
        </div>
        
        <form method="POST">
            <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 20px;">
                <div class="form-group">
                    <label class="form-label">Room Title</label>
                    <input type="text" name="title" class="form-input" value="{{ room.title }}" required>
                </div>
                <div class="form-group">
                    <label class="form-label">Monthly Rent (â‚¹)</label>
                    <input type="number" name="price" class="form-input" value="{{ room.price_per_month }}" required>
                </div>
            </div>

            <!-- Image Upload -->
            <div class="form-group">
                <label class="form-label">Room Images</label>
                <div class="image-upload-box">
                    <p style="font-size: 0.9rem; color: #64748b; margin-bottom: 12px;">Main Image:</p>
                    <input type="text" name="image_url" class="form-input" value="{{ room.image_url }}" required style="margin-bottom: 12px;">
                    
                    <div id="moreImagesContainer">
                        {% if room.more_images %}
                            {% for img in room.more_images %}
                            <input type="text" name="more_images" class="form-input" value="{{ img }}" style="margin-bottom: 12px;">
                            {% endfor %}
                        {% endif %}
                    </div>
                    
                    <button type="button" class="add-img-btn" onclick="addMoreImages()">
                        <i class="fas fa-plus-circle"></i> Add Another Image
                    </button>
                </div>
            </div>
            
            <!-- Amenities -->
            <div class="form-group">
                <label class="form-label" style="margin-bottom: 15px;">Features & Amenities</label>
                <div class="amenities-grid">
                    {% set all_amenities = ["Wifi", "AC", "Attached Bath", "Geyser", "Furnished", "TV", "Fridge", "Washing Machine", "Power Backup", "Lift", "Parking", "CCTV", "Balcony", "Housekeeping", "Pet Friendly", "No Restrictions"] %}
                    
                    {% for amenity in all_amenities %}
                    <label>
                        <input type="checkbox" name="amenities" value="{{ amenity }}" class="amenity-checkbox" {% if room.amenities and amenity in room.amenities %}checked{% endif %}>
                        <span class="amenity-label">{{ amenity }}</span>
                    </label>
                    {% endfor %}
                </div>
            </div>
            
            <div class="form-group">
                <label class="form-label">Description</label>
                <textarea name="description" rows="4" class="form-textarea">{{ room.description }}</textarea>
            </div>

            <button type="submit" class="submit-btn">
                <i class="fas fa-save" style="margin-right: 8px;"></i> Save Changes
            </button>
        </form>
    </div>
</div>

<script>
    function addMoreImages() {
        const container = document.getElementById('moreImagesContainer');
        const input = document.createElement('input');
        input.type = 'text'; input.name = 'more_images'; input.className = 'form-input'; input.placeholder = 'Additional Image URL'; input.style.marginBottom = '12px';
        container.appendChild(input);
    }
</script>
{% endblock %}